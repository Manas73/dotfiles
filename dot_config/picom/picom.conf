#################################
#              Rules            #
#################################
rules = (
  # Animation on geometry change for non-floating windows
  {
    match = "FLOATING@ != 1";
    animations = (
      {
        triggers = [ "geometry" ];
        preset = "geometry-change";
        duration = 0.2;
      }
    );
  },

  # Opacity rules
  {
    match = "focused: 0";
    opacity = 1.0;
    dim = 0.2;
  },
  {
    match = "focused: 1";
    opacity = 1.0;
  },

  # Disable shadows for specific windows
  {
    match = "class_g *= 'zoom'";
    shadow = false;
  },
  {
    match = "name = 'cpt_frame_window'";
    shadow = false;
  },
  {
    match = "name = 'cpt_frame_xcb_window'";
    shadow = false;
  },
  {
    match = "name = 'as_toolbar'";
    shadow = false;
  },

  # Rounded corners exclusions
  {
    match = "window_type = 'dock'";
    corner-radius = 0;
  },
  {
    match = "window_type = 'desktop'";
    corner-radius = 0;
  },

  # Blur exclusions
  {
    match = "window_type = 'dock'";
    blur-background = false;
  },
  {
    match = "window_type = 'desktop'";
    blur-background = false;
  },
  {
    match = "window_type = 'menu'";
    blur-background = false;
  },
  {
    match = "window_type = 'dropdown_menu'";
    blur-background = false;
  },
  {
    match = "window_type = 'popup_menu'";
    blur-background = false;
  },
  {
    match = "window_type = 'tooltip'";
    blur-background = false;
  },
  {
    match = "_GTK_FRAME_EXTENTS@:c";
    blur-background = false;
  },
  {
    match = "class_g = 'ulauncher'";
    blur-background = false;
  },
  {
    match = "class_g *= 'zoom'";
    blur-background = false;
  },
  {
    match = "name = 'cpt_frame_window'";
    blur-background = false;
  },
  {
    match = "name = 'cpt_frame_xcb_window'";
    blur-background = false;
  },
  {
    match = "name = 'as_toolbar'";
    blur-background = false;
  },

  # Window-type specific behavior
  {
    match = "window_type = 'tooltip'";
    fade = true;
    opacity = 1.0;
    focus = true;
    full-shadow = false;
  },
  {
    match = "window_type = 'dock'";
    shadow = false;
    clip-shadow-above = true;
  },
  {
    match = "window_type = 'dnd'";
    shadow = false;
  },
  {
    match = "window_type = 'popup_menu'";
    opacity = 1.0;
  },
  {
    match = "window_type = 'dropdown_menu'";
    opacity = 1.0;
  },
  {
    match = "window_type = 'notification'";
    opacity = 1.0;
  }
);

#################################
#             Shadows           #
#################################

shadow = false;
shadow-radius = 7;
shadow-offset-x = -7;
shadow-offset-y = -7;

#################################
#           Fading              #
#################################

fading = true;
fade-in-step = 0.03;
fade-out-step = 0.03;

#################################
#           Corners             #
#################################

corner-radius = 10;
round-borders = 1;

#################################
#     Background-Blurring       #
#################################

blur-method = "dual_kawase";
blur-strength = 3;

#################################
#       General Settings        #
#################################

backend = "glx";
vsync = true;
detect-rounded-corners = true;
detect-client-opacity = true;
detect-transient = true;
use-damage = true;
log-level = "warn";

#################################
#          Animations           #
#################################

animations = (
  {
    triggers = [ "open" ];
    preset = "appear";
    duration = 0.2;
  },
  {
    triggers = [ "close" ];
    preset = "disappear";
    duration = 0.2;
  },
  {
    triggers = [ "geometry" ];
    offset-x = {
      curve = "cubic-bezier(0.17, 0.67, 0.68, 1.03)";
      end = 0;
      duration = "duration";
      start = "- offset";
    };
    shadow-offset-x = "offset-x";
    offset = 10;
    duration = 0.2;
  }
);
